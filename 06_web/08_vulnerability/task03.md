# 課題03

## 準備

### install

<https://www.kali.org/tools/dvwa/>

```sh
sudo apt install dvwa
dvwa-start
```

### setup

`Setup / Reset DB`を開き、`Create / Reset Database`をクリックする。  
`DVWA Security`を開き、`low`を選択してsubmitする。  

## 攻撃

### コマンドインジェクション

```sh
127.0.0.1; ls
```

- 防御手段
  - ホワイトリストで許可する文字を絞る
  - 入力値をエスケープ, サニタイズする

### SQLインジェクション

```sh
' or 'a'='a
```

- 防御手段
  - ホワイトリストで許可する文字を絞る
  - 入力値をエスケープ, サニタイズする

### CSRF

```url
http://127.0.0.1:42001/vulnerabilities/csrf/?password_new=pass&password_conf=pass&Change=Change
```

- 防御手段
  - CSRFトークンを埋め込む
  - SameSite Cookie Lax/Strictを設定する

### XSS

```js
<script>alert('Hi');</script>
```

- 防御手段
  - ホワイトリストで許可する文字を絞る
  - 入力値をエスケープ, サニタイズする
  - CookieのHttpOnly属性を設定する
